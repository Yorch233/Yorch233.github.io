import{_ as Ja,r as c,c as _,v as Tt,o as Lt,x as Qa,w as X,b as m,d as p,e as s,t as b,q as D,F as G,f as H,i as A,n as N,g as na,T as Pt,m as ra,y as ye,z as Se,A as Dt}from"./index-qYwGKSUm.js";const At="/logo/icon.png",Et="/assets/050a050v_c1_152_t60_1.57-DNo8cVUf.wav",It="/assets/051o020a_c1_454_snr_5.2-CdviCkkA.wav",Kt="/assets/051o020t_c1_473_snr_8.3-DXotndtl.wav",qt="/assets/053c010d_c1_896_snr_1.1-4ZRpcxme.wav",Wt="/assets/053c010k_c1_903_snr_-5.0-CWAvcMMp.wav",zt="/assets/22gc0110_c1_1161_t60_1.72-HCn2IUO0.wav",Ft="/assets/420c020o_c1_1633_t60_1.19-CZZILkBS.wav",Gt="/assets/421c0214_c2_1769_t60_1.86-BwLoPT-M.wav",Ht="/assets/421o0307_c1_1896_snr_8.7-C2vI2qWK.wav",jt="/assets/422c020d_c2_1982_t60_1.68-DKIeiLVA.wav",Ot="/assets/050a050v_c1_152_t60_1.57-BpZyqh7B.wav",Ut="/assets/051o020a_c1_454_snr_5.2-BhY7mBGc.wav",Vt="/assets/051o020t_c1_473_snr_8.3-BTvvsHpL.wav",Yt="/assets/053c010d_c1_896_snr_1.1-DSqvW6dW.wav",Qt="/assets/053c010k_c1_903_snr_-5.0-BUFH6a9r.wav",Zt="/assets/22gc0110_c1_1161_t60_1.72-C4wu8c4P.wav",Jt="/assets/420c020o_c1_1633_t60_1.19-BpRbwu1-.wav",Xt="/assets/421c0214_c2_1769_t60_1.86-Q7z4cpcW.wav",es="/assets/421o0307_c1_1896_snr_8.7-rsrNDu-g.wav",as="/assets/422c020d_c2_1982_t60_1.68-BpjeU09r.wav",ts="/assets/050a050v_c1_152_t60_1.57-CvhZDAyo.wav",ss="/assets/051o020a_c1_454_snr_5.2-DYetsLjT.wav",os="/assets/051o020t_c1_473_snr_8.3-CwOK4UG4.wav",ns="/assets/053c010d_c1_896_snr_1.1-DpfHFcYn.wav",rs="/assets/053c010k_c1_903_snr_-5.0-DiaqB7a6.wav",ls="/assets/22gc0110_c1_1161_t60_1.72-DEQ4-1E8.wav",is="/assets/420c020o_c1_1633_t60_1.19-Cl8HdOAU.wav",cs="/assets/421c0214_c2_1769_t60_1.86-Cbo1o95C.wav",us="/assets/421o0307_c1_1896_snr_8.7-DklYkS7I.wav",ds="/assets/422c020d_c2_1982_t60_1.68-65bJ9H90.wav",vs="/assets/050a050v_c1_152_t60_1.57-DqXrYtBJ.wav",_s="/assets/051o020a_c1_454_snr_5.2-CWhTvTAa.wav",ms="/assets/051o020t_c1_473_snr_8.3-qM_ibCXt.wav",ps="/assets/053c010d_c1_896_snr_1.1-BBcDxnp-.wav",hs="/assets/053c010k_c1_903_snr_-5.0-UQKnp7wS.wav",gs="/assets/22gc0110_c1_1161_t60_1.72-DjmWrned.wav",fs="/assets/420c020o_c1_1633_t60_1.19-DplED0NS.wav",bs="/assets/421c0214_c2_1769_t60_1.86-BKkjs79k.wav",ws="/assets/421o0307_c1_1896_snr_8.7-CtAulGKl.wav",ys="/assets/422c020d_c2_1982_t60_1.68-D95Z-yxq.wav",Ss="/assets/050a050v_c1_152_t60_1.57-BfOoGZjy.wav",Ms="/assets/051o020a_c1_454_snr_5.2-C4Y0qzGO.wav",Rs="/assets/051o020t_c1_473_snr_8.3-Cv07XJiA.wav",Bs="/assets/053c010d_c1_896_snr_1.1-CWrNQ9FV.wav",ks="/assets/053c010k_c1_903_snr_-5.0-BP4JaKOh.wav",xs="/assets/22gc0110_c1_1161_t60_1.72-CcNyNj2z.wav",Cs="/assets/420c020o_c1_1633_t60_1.19-D7_rvMiY.wav",$s="/assets/421c0214_c2_1769_t60_1.86-D6bCPskW.wav",Ns="/assets/421o0307_c1_1896_snr_8.7-D8ttMFfp.wav",Ts="/assets/422c020d_c2_1982_t60_1.68-BfRh0UNf.wav",Ls="/assets/050a050v_c1_152_t60_1.57-BDj51lym.wav",Ps="/assets/051o020a_c1_454_snr_5.2-C_wnR76_.wav",Ds="/assets/051o020t_c1_473_snr_8.3-D9lIPD4L.wav",As="/assets/053c010d_c1_896_snr_1.1-BPNjN9ef.wav",Es="/assets/053c010k_c1_903_snr_-5.0-C1Hf_kB-.wav",Is="/assets/22gc0110_c1_1161_t60_1.72-CgmK3u29.wav",Ks="/assets/420c020o_c1_1633_t60_1.19-DcQrH1YJ.wav",qs="/assets/421c0214_c2_1769_t60_1.86-CB09amZ6.wav",Ws="/assets/421o0307_c1_1896_snr_8.7-D3VPf2Qg.wav",zs="/assets/422c020d_c2_1982_t60_1.68-D4yo4deO.wav",Fs={class:"wave-header"},Gs={class:"wave-description"},Hs={class:"wave-desc-item"},js={key:0,class:"wave-desc-index"},Os={class:"wave-desc-item"},Us={class:"wave-desc-value"},Vs={class:"wave-desc-item wave-desc-tooltip"},Ys={class:"wave-desc-label"},Qs={class:"wave-desc-value"},Zs={key:0,class:"wave-desc-tip"},Js={class:"method-list"},Xs={class:"method-group method-group-primary"},eo=["onMouseenter"],ao=["disabled","onClick"],to={class:"chip-label"},so={key:0,class:"chip-spinner","aria-hidden":"true"},oo={key:1,class:"chip-action","aria-hidden":"true"},no=["src"],ro={key:0,class:"method-group method-group-secondary"},lo={class:"method-group-scroll"},io=["onMouseenter"],co=["disabled","onClick"],uo={class:"chip-label"},vo={key:0,class:"chip-spinner","aria-hidden":"true"},_o={key:1,class:"chip-action","aria-hidden":"true"},mo=["src"],po={class:"wave-panel"},ho={class:"wave-panel-header"},go={class:"wave-panel-title"},fo={class:"wave-panel-actions"},bo={class:"view-toggle",role:"group","aria-label":"Visualization mode"},wo={class:"wave-canvas-wrap","aria-hidden":"true"},yo={key:0,class:"canvas-loading wave-loading"},So={class:"wave-time-axis","aria-hidden":"true"},Mo={class:"time-axis-track"},Ro={class:"time-axis-label"},Bo={class:"time-axis-caret-label"},ko={class:"spectrogram-block","aria-hidden":"true"},xo={class:"spectrogram-labels"},Co={class:"spectrogram-label"},$o={class:"spectrogram-label"},No={class:"spectrogram-row"},To={class:"spectrogram-axis spectrogram-axis-y"},Lo={class:"spectrogram-axis-label"},Po={class:"spectrogram-axis spectrogram-axis-x"},Do={class:"spectrogram-axis-label"},Ao={key:0,class:"canvas-loading spectrogram-loading"},Eo={class:"spectrogram-axis spectrogram-axis-y"},Io={class:"spectrogram-axis-label"},Ko={class:"spectrogram-axis spectrogram-axis-x"},qo={class:"spectrogram-axis-label"},Wo={key:0,class:"spectrogram-placeholder"},zo={key:1,class:"canvas-loading spectrogram-loading"},Fo={class:"spectrogram-controls","aria-hidden":"true"},Go={class:"spectrogram-quality"},Ho={class:"spectrogram-quality-options",role:"group","aria-label":"Spectrogram quality"},jo=["onClick"],Oo={class:"progress-row"},Uo=["aria-label"],Vo=["src","alt"],Yo={class:"time-label"},Qo=["value"],Zo={class:"time-label"},Jo={class:"volume-control"},Xo=["aria-label"],en=["src","alt"],an={class:"volume-popover"},tn={class:"volume-label"},sn={class:"volume-slider-wrap"},on=["value"],nn=["src"],rn=40,ln={__name:"AudioWaveCompare",props:{sampleName:{type:String,required:!0},sampleIndex:{type:Number,default:null},methods:{type:Array,default:()=>[]},defaultMethod:{type:String,default:"Measurement"},cleanKey:{type:String,default:"Ground_Truth"},measurementKey:{type:String,default:"Measurement"}},setup(la){var Ua;const x=c(100),i=la,j=[{key:"Ground_Truth",label:"Ground Truth (Clean)"},{key:"Measurement",label:"Measurement (Noisy/Reverb)"},{key:"NCSN+M",label:"NCSN+M"},{key:"SB",label:"SB"},{key:"StoRM",label:"StoRM"},{key:"RSB",label:"RSB (Ours)"}],T=_(()=>{var e;return(e=i.methods)!=null&&e.length?i.methods:j}),K=_(()=>{const e=[...T.value],a=e.find(r=>r.key===i.measurementKey),t=e.find(r=>r.key===i.cleanKey),o=e.filter(r=>r.key!==i.measurementKey&&r.key!==i.cleanKey);return[a,...o,t].filter(Boolean)}),w=c(i.defaultMethod),ee=c(null),ie=c(null),ce=c(null),ue=c(null),de=c(null),ae=c(null),C=c(null),ia=c(null),y=c(null),k=c(null),q=c(1),Y=c(0),S=c(0),ve=c(!1),ca=c(0),Ae=c(!1),ua=c(0),_e=c(null),me=c(null),Ee=c(!1),Ue=c(!1),$=c("waveform"),Q=c(!1),Z=c(!1),O=c(!1),Ve=c({x:0,y:0}),J=c(!1),da=c(!0),va=c(!0),Me=c(""),Re=c(""),W=c(!1),pe=c(""),Ie=c({}),Xa=_(()=>Be(i.cleanKey)),Ke=_(()=>Be(w.value)),et=_(()=>Be(i.measurementKey));_(()=>{var e;return((e=T.value.find(a=>a.key===i.cleanKey))==null?void 0:e.label)||"Ground Truth"});const _a=_(()=>{var e;return((e=T.value.find(a=>a.key===w.value))==null?void 0:e.label)||w.value}),ma=_(()=>{var e;return((e=T.value.find(a=>a.key===i.measurementKey))==null?void 0:e.label)||"Measurement"}),L=_(()=>w.value!==i.measurementKey),qe=_(()=>Xe[i.measurementKey]||"#ef4444"),We=_(()=>Xe[w.value]||"#0a84ff"),Ye=_(()=>S.value?Y.value/S.value*100:0),at=_(()=>({background:`linear-gradient(90deg, #0a84ff 0%, #0a84ff ${Ye.value}%, #e2e8f0 ${Ye.value}%, #e2e8f0 100%)`})),tt=_(()=>Math.max(0,S.value-Y.value)),st=_(()=>re(ca.value)),ot=_(()=>S.value?Y.value/S.value*100:0),he=_(()=>{if(!S.value||S.value<=0)return[];const e=[];for(let a=0;a<=Math.floor(S.value);a+=1)e.push(a);return e}),nt=_(()=>he.value.length?he.value[he.value.length-1]:0),pa=_(()=>[0,2,4,6,8]),rt=_(()=>ve.value?"/logo/reload.svg":W.value?"/logo/player-pause.svg":"/logo/player-play.svg"),ha=_(()=>ve.value?"Replay":W.value?"Pause":"Play"),lt=_(()=>i.sampleName),ga=_(()=>Number.isFinite(i.sampleIndex)&&i.sampleIndex>0?`#${i.sampleIndex}`:""),ze=_(()=>{const e=i.sampleName.match(/snr=([\-\d]+(?:\.\d+)?)/i);if(e)return{label:"SNR",value:`${e[1]} dB`,tooltip:"Signal-to-noise ratio (SNR) measures speech strength relative to background noise. Higher is cleaner."};const a=i.sampleName.match(/t60=([\-\d]+(?:\.\d+)?)/i);return a?{label:"T60",value:`${a[1]} s`,tooltip:"Reverberation time (T60) is the time for sound to decay by 60 dB. Lower means less reverberation."}:{label:"Metric",value:"—",tooltip:""}}),fa=_(()=>Math.round(x.value)),it=_(()=>x.value<=0?"/logo/volume-off.svg":x.value<100?"/logo/volume-2.svg":"/logo/volume.svg"),ba=_(()=>x.value<=0?"Mute":"Volume"),te=_(()=>me.value??_e.value),ct=_(()=>te.value==="compare"?.1:1),ut=_(()=>te.value==="measurement"?.1:1),Qe=_(()=>{const e=L.value?.45:1;return te.value==="compare"?.1:me.value==="measurement"?1:e}),Ze=_(()=>te.value==="measurement"?.1:.9),wa=_(()=>Me.value||Re.value?Me.value||Re.value:""),se={instance:null,decodeContext:null},Fe=new Map,E=new Map,oe=c(1),Je=_(()=>({1:1,2:1.6,3:2.2,4:3,5:4})[oe.value]??2.2),Ge=(Ua=Tt())==null?void 0:Ua.appContext.config.globalProperties.$messageBox,dt=async e=>{if(e!==oe.value){if(!(Ge!=null&&Ge.confirm)){oe.value=e;return}try{await Ge.confirm({title:"Spectrogram Quality",message:'Notice: Higher quality means longer rendering time. <span style="color:#ef4444;font-weight:600;">It may even cause the browser to crash. Please save any unsaved work in other tabs first.</span>',closeOnClickOverlay:!0}),oe.value=e}catch{}}},Xe={Measurement:"#ff9d00",Ground_Truth:"#3b82f6","NCSN+M":"#22c55e","NCSN++M":"#22c55e",SB:"#a855f7",StoRM:"#14b8a6",RSB:"#f97316"},vt={Measurement:"Measurement is the degraded speech corrupted by noise and reverberation.",Ground_Truth:"Ground Truth is the original clean speech.","NCSN++M":"NCSN++M is a common backbone of diffusion models used here as a purely predictive method, trained with an MSE loss to predict clean speech.",SB:"SB models the transport between noisy and clean speech directly via Schrödinger Bridge. It is our baseline method.",StoRM:"StoRM is a hybrid method that cascades a predictive model with a diffusion model. The diffusion model refines details from the initial predictive estimate.",RSB:"RSB is the proposed method in this paper."},U=(e,a)=>{Ie.value={...Ie.value,[e]:a}},ne=e=>Ie.value[e]==="ready",Be=e=>new URL(Object.assign({"../assets/RSB/audio/Ground_Truth/050a050v_c1_152_t60=1.57.wav":Et,"../assets/RSB/audio/Ground_Truth/051o020a_c1_454_snr=5.2.wav":It,"../assets/RSB/audio/Ground_Truth/051o020t_c1_473_snr=8.3.wav":Kt,"../assets/RSB/audio/Ground_Truth/053c010d_c1_896_snr=1.1.wav":qt,"../assets/RSB/audio/Ground_Truth/053c010k_c1_903_snr=-5.0.wav":Wt,"../assets/RSB/audio/Ground_Truth/22gc0110_c1_1161_t60=1.72.wav":zt,"../assets/RSB/audio/Ground_Truth/420c020o_c1_1633_t60=1.19.wav":Ft,"../assets/RSB/audio/Ground_Truth/421c0214_c2_1769_t60=1.86.wav":Gt,"../assets/RSB/audio/Ground_Truth/421o0307_c1_1896_snr=8.7.wav":Ht,"../assets/RSB/audio/Ground_Truth/422c020d_c2_1982_t60=1.68.wav":jt,"../assets/RSB/audio/Measurement/050a050v_c1_152_t60=1.57.wav":Ot,"../assets/RSB/audio/Measurement/051o020a_c1_454_snr=5.2.wav":Ut,"../assets/RSB/audio/Measurement/051o020t_c1_473_snr=8.3.wav":Vt,"../assets/RSB/audio/Measurement/053c010d_c1_896_snr=1.1.wav":Yt,"../assets/RSB/audio/Measurement/053c010k_c1_903_snr=-5.0.wav":Qt,"../assets/RSB/audio/Measurement/22gc0110_c1_1161_t60=1.72.wav":Zt,"../assets/RSB/audio/Measurement/420c020o_c1_1633_t60=1.19.wav":Jt,"../assets/RSB/audio/Measurement/421c0214_c2_1769_t60=1.86.wav":Xt,"../assets/RSB/audio/Measurement/421o0307_c1_1896_snr=8.7.wav":es,"../assets/RSB/audio/Measurement/422c020d_c2_1982_t60=1.68.wav":as,"../assets/RSB/audio/NCSN++M/050a050v_c1_152_t60=1.57.wav":ts,"../assets/RSB/audio/NCSN++M/051o020a_c1_454_snr=5.2.wav":ss,"../assets/RSB/audio/NCSN++M/051o020t_c1_473_snr=8.3.wav":os,"../assets/RSB/audio/NCSN++M/053c010d_c1_896_snr=1.1.wav":ns,"../assets/RSB/audio/NCSN++M/053c010k_c1_903_snr=-5.0.wav":rs,"../assets/RSB/audio/NCSN++M/22gc0110_c1_1161_t60=1.72.wav":ls,"../assets/RSB/audio/NCSN++M/420c020o_c1_1633_t60=1.19.wav":is,"../assets/RSB/audio/NCSN++M/421c0214_c2_1769_t60=1.86.wav":cs,"../assets/RSB/audio/NCSN++M/421o0307_c1_1896_snr=8.7.wav":us,"../assets/RSB/audio/NCSN++M/422c020d_c2_1982_t60=1.68.wav":ds,"../assets/RSB/audio/RSB/050a050v_c1_152_t60=1.57.wav":vs,"../assets/RSB/audio/RSB/051o020a_c1_454_snr=5.2.wav":_s,"../assets/RSB/audio/RSB/051o020t_c1_473_snr=8.3.wav":ms,"../assets/RSB/audio/RSB/053c010d_c1_896_snr=1.1.wav":ps,"../assets/RSB/audio/RSB/053c010k_c1_903_snr=-5.0.wav":hs,"../assets/RSB/audio/RSB/22gc0110_c1_1161_t60=1.72.wav":gs,"../assets/RSB/audio/RSB/420c020o_c1_1633_t60=1.19.wav":fs,"../assets/RSB/audio/RSB/421c0214_c2_1769_t60=1.86.wav":bs,"../assets/RSB/audio/RSB/421o0307_c1_1896_snr=8.7.wav":ws,"../assets/RSB/audio/RSB/422c020d_c2_1982_t60=1.68.wav":ys,"../assets/RSB/audio/SB/050a050v_c1_152_t60=1.57.wav":Ss,"../assets/RSB/audio/SB/051o020a_c1_454_snr=5.2.wav":Ms,"../assets/RSB/audio/SB/051o020t_c1_473_snr=8.3.wav":Rs,"../assets/RSB/audio/SB/053c010d_c1_896_snr=1.1.wav":Bs,"../assets/RSB/audio/SB/053c010k_c1_903_snr=-5.0.wav":ks,"../assets/RSB/audio/SB/22gc0110_c1_1161_t60=1.72.wav":xs,"../assets/RSB/audio/SB/420c020o_c1_1633_t60=1.19.wav":Cs,"../assets/RSB/audio/SB/421c0214_c2_1769_t60=1.86.wav":$s,"../assets/RSB/audio/SB/421o0307_c1_1896_snr=8.7.wav":Ns,"../assets/RSB/audio/SB/422c020d_c2_1982_t60=1.68.wav":Ts,"../assets/RSB/audio/StoRM/050a050v_c1_152_t60=1.57.wav":Ls,"../assets/RSB/audio/StoRM/051o020a_c1_454_snr=5.2.wav":Ps,"../assets/RSB/audio/StoRM/051o020t_c1_473_snr=8.3.wav":Ds,"../assets/RSB/audio/StoRM/053c010d_c1_896_snr=1.1.wav":As,"../assets/RSB/audio/StoRM/053c010k_c1_903_snr=-5.0.wav":Es,"../assets/RSB/audio/StoRM/22gc0110_c1_1161_t60=1.72.wav":Is,"../assets/RSB/audio/StoRM/420c020o_c1_1633_t60=1.19.wav":Ks,"../assets/RSB/audio/StoRM/421c0214_c2_1769_t60=1.86.wav":qs,"../assets/RSB/audio/StoRM/421o0307_c1_1896_snr=8.7.wav":Ws,"../assets/RSB/audio/StoRM/422c020d_c2_1982_t60=1.68.wav":zs})[`../assets/RSB/audio/${e}/${i.sampleName}`],import.meta.url).href,ke=()=>{if(!se.instance){const e=window.AudioContext||window.webkitAudioContext;se.instance=new e}return se.instance},_t=()=>{if(!se.decodeContext){const e=window.OfflineAudioContext||window.webkitOfflineAudioContext;e?se.decodeContext=new e(1,1,44100):se.decodeContext=ke()}return se.decodeContext},He=async e=>{if(Fe.has(e))return Fe.get(e);const a=await fetch(e);if(!a.ok)throw new Error(`Failed to fetch audio: ${a.status}`);const t=await a.arrayBuffer(),o=_t();try{const r=await o.decodeAudioData(t.slice(0));return Fe.set(e,r),r}catch{const n=ke();if(n.state==="suspended")try{await n.resume()}catch{}const l=await n.decodeAudioData(t.slice(0));return Fe.set(e,l),l}},ya=e=>{const a=e.getChannelData(0);let t=0;for(let o=0;o<a.length;o+=1){const r=Math.abs(a[o]);r>t&&(t=r)}return t===0?1:.95/t},Sa=(e,a,t,o,r={})=>{if(!e||!a)return;const{color:n="#2563eb",alpha:l=1,scale:v=1}=r,u=a.getChannelData(0),d=Math.max(1,Math.floor(u.length/t)),g=o/2;e.strokeStyle=n,e.globalAlpha=l,e.lineWidth=1,e.beginPath();for(let M=0;M<t;M+=1){const f=M*d;let R=1,h=-1;for(let B=0;B<d;B+=1){const F=u[f+B]??0;F<R&&(R=F),F>h&&(h=F)}const I=Math.max(-1,Math.min(1,R*v)),P=Math.max(-1,Math.min(1,h*v));e.moveTo(M,(1+I)*g),e.lineTo(M,(1+P)*g)}e.stroke(),e.globalAlpha=1},Ma=e=>e.join("|"),ea=(e,a)=>{E.size>=rn&&E.clear(),E.set(e,a)},Ra=e=>{const a=e.replace("#","");if(a.length!==6)return{r:15,g:23,b:42};const t=Number.parseInt(a,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},Ba=(e,a,t)=>{const o=Ra(e),r=Ra(a),n=Math.min(1,Math.max(0,t)),l=Math.round(o.r+(r.r-o.r)*n),v=Math.round(o.g+(r.g-o.g)*n),u=Math.round(o.b+(r.b-o.b)*n);return`rgb(${l}, ${v}, ${u})`},ka=(e,a,t,o,r,n,l)=>{const v=()=>{if(!k.value)return;e.save(),e.beginPath(),e.rect(0,r,o,n),e.clip(),e.save(),e.translate(0,r);const d=l==="muted"?Ba(qe.value,"#f8fafc",.65):qe.value;Sa(e,k.value,o,n,{color:d,alpha:Qe.value,scale:q.value}),e.restore(),e.restore()},u=()=>{if(!y.value||!L.value)return;e.save(),e.beginPath(),e.rect(0,r,o,n),e.clip(),e.save(),e.translate(0,r);const d=l==="muted"?Ba(We.value,"#f8fafc",.65):We.value;Sa(e,y.value,o,n,{color:d,alpha:Ze.value,scale:q.value}),e.restore(),e.restore()};te.value==="measurement"?(u(),v()):(te.value,v(),u())},xa=(e,a,t,o,r,n)=>{const l=r+n/2,v=n/2;[1,.5,0,-.5,-1].forEach(d=>{const g=l-d*v;e.beginPath(),e.lineWidth=d===0?1.4:1,e.strokeStyle=d===0?"rgba(148, 163, 184, 0.55)":"rgba(148, 163, 184, 0.25)",e.moveTo(0,g),e.lineTo(o,g),e.stroke()})},Ca=(e,a,t,o,r)=>{const n=o+r/2,l=r/2,v=[1,.5,0,-.5,-1],u=a-6;e.font='10px "Times New Roman", serif',e.textAlign="right",e.textBaseline="middle",e.fillStyle="rgba(100, 116, 139, 0.9)",v.forEach(d=>{const g=n-d*l;e.fillText(d.toFixed(1),u,g)})},$a=(e,a,t,o)=>{if(!Number.isFinite(o))return;const r=W.value?.6+.4*Math.sin(performance.now()*.008):1;e.beginPath(),e.lineWidth=J.value?2.6:1.3,e.strokeStyle=`rgba(148, 163, 184, ${.8*r})`,e.moveTo(o,0),e.lineTo(o,t),e.stroke()},z=()=>{if($.value==="spectrogram"){Z.value=!0,La(),Q.value=!1;return}const e=ie.value;if(!e){Q.value=!1;return}const a=e.getBoundingClientRect(),t=a.height||110,o=a.width||480,r=window.devicePixelRatio||1;e.width=o*r,e.height=t*r;const n=e.getContext("2d");if(!n){Q.value=!1;return}const l=Ma(["waveform",i.sampleName,w.value,te.value??"none",L.value?"1":"0",k.value?"m1":"m0",y.value?"c1":"c0",q.value,qe.value,We.value,Qe.value,Ze.value,o,t,r]),v=`${l}|normal`,u=`${l}|muted`,d=E.get(v),g=E.get(u);n.setTransform(r,0,0,r,0,0),n.clearRect(0,0,o,t);const M=28,f=10,R=10,h=Math.max(0,o-M),I=Math.max(0,t-f-R),P=S.value?Y.value/S.value*h:0;if(d&&g){Q.value=!1,xa(n,o,t,h,f,I),n.save(),n.globalAlpha=1,n.beginPath(),n.rect(0,0,Math.max(0,Math.min(h,P)),t),n.clip(),n.drawImage(d,0,0,o,t),n.restore(),n.save(),n.beginPath(),n.rect(Math.max(0,Math.min(h,P)),0,h,t),n.clip(),n.drawImage(g,0,0,o,t),n.restore(),Ca(n,o,t,f,I),$a(n,h,t,P),e.style.opacity="1";return}e.style.opacity="0",Q.value=!0;const B=document.createElement("canvas");B.width=o*r,B.height=t*r;const F=B.getContext("2d");if(!F){Q.value=!1;return}F.setTransform(r,0,0,r,0,0),ka(F,o,t,h,f,I,"normal"),ea(v,B);const le=document.createElement("canvas");le.width=o*r,le.height=t*r;const be=le.getContext("2d");be&&(be.setTransform(r,0,0,r,0,0),ka(be,o,t,h,f,I,"muted"),ea(u,le)),xa(n,o,t,h,f,I),n.save(),n.globalAlpha=1,n.beginPath(),n.rect(0,0,Math.max(0,Math.min(h,P)),t),n.clip(),n.drawImage(B,0,0,o,t),n.restore(),n.save(),n.beginPath(),n.rect(Math.max(0,Math.min(h,P)),0,h,t),n.clip(),n.drawImage(le,0,0,o,t),n.restore(),Ca(n,o,t,f,I),$a(n,h,t,P),requestAnimationFrame(()=>{e.style.opacity="1",Q.value=!1})},xe=[[0,0,0,4],[.1,25,6,64],[.2,53,11,99],[.3,84,21,117],[.4,113,31,126],[.5,142,41,122],[.6,170,54,99],[.7,198,72,70],[.8,225,101,40],[.9,246,136,22],[1,252,181,20]],mt=()=>{switch(oe.value){case 1:return{fftSize:512,hopLength:256};case 2:return{fftSize:512,hopLength:128};case 3:return{fftSize:1024,hopLength:128};case 4:return{fftSize:1024,hopLength:64};case 5:return{fftSize:2048,hopLength:64};default:return{fftSize:1024,hopLength:128}}},pt=e=>{const a=Math.min(1,Math.max(0,e));for(let o=0;o<xe.length-1;o+=1){const[r,n,l,v]=xe[o],[u,d,g,M]=xe[o+1];if(a>=r&&a<=u){const f=(a-r)/(u-r);return{r:Math.round(n+(d-n)*f),g:Math.round(l+(g-l)*f),b:Math.round(v+(M-v)*f)}}}const t=xe[xe.length-1];return{r:t[1],g:t[2],b:t[3]}},ht=(e,a,t,o,r)=>{const n=a.getChannelData(0),{fftSize:l,hopLength:v}=mt(),u=l/2,d=Math.max(1,Math.floor((n.length-l)/v)+1),g=new Float32Array(l);for(let B=0;B<l;B+=1)g[B]=.5-.5*Math.cos(2*Math.PI*B/(l-1));const M=-60,f=0,R=1e-10,h=a.sampleRate/2,P=Math.min(u,Math.max(8,Math.floor(1e4/h*u)));for(let B=0;B<t;B+=1){const F=Math.min(d-1,Math.floor(B/t*d)),le=Math.min(F*v,Math.max(0,n.length-l)),be=new Float32Array(u);for(let V=0;V<u;V+=1){let Le=0,we=0;for(let De=0;De<l;De+=1){const Va=(n[le+De]||0)*g[De],Ya=2*Math.PI*V*De/l;Le+=Va*Math.cos(Ya),we-=Va*Math.sin(Ya)}const Pe=Math.sqrt(Le*Le+we*we),Nt=20*Math.log10(.1*Pe+R);be[V]=Math.min(1,Math.max(0,(Nt-M)/(f-M)))}for(let V=0;V<o;V+=1){const Le=Math.floor(V/o*P),we=be[Le]||0;if(we<=0)continue;const Pe=pt(we);e.fillStyle=`rgb(${Pe.r}, ${Pe.g}, ${Pe.b})`,e.fillRect(B,o-V-1,1,1)}}},je=(e,a,t,o)=>{if(!e||!a)return;const r=e.getBoundingClientRect(),n=r.height||110,l=r.width||240,v=(window.devicePixelRatio||1)*Je.value,u=Math.max(1,Math.floor(l*v)),d=Math.max(1,Math.floor(n*v)),g=`${t}|${l}|${n}|${v}`;e.width=u,e.height=d;const M=e.getContext("2d");if(!M)return;const f=E.get(g);if(M.setTransform(1,0,0,1,0,0),M.clearRect(0,0,u,d),f){M.drawImage(f,0,0,u,d);return}const R=document.createElement("canvas");R.width=u,R.height=d;const h=R.getContext("2d");h&&(h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,u,d),h.fillStyle="#0b0f16",h.fillRect(0,0,u,d),ht(h,a,u,d),ea(g,R),M.drawImage(R,0,0,u,d))},Na=(e,a)=>{if(!e||!a||!O.value)return;const t=e.getBoundingClientRect(),o=t.width||0,r=t.height||0;if(!o||!r)return;const n=window.devicePixelRatio||1;a.width=o*n,a.height=r*n;const l=a.getContext("2d");if(!l)return;l.setTransform(n,0,0,n,0,0),l.clearRect(0,0,o,r);const v=2.2,u=140,d=90,g=Math.min(1,Math.max(0,Ve.value.x)),M=Math.min(1,Math.max(0,Ve.value.y));let f=g*o-u/2,R=M*r-d/2;f=Math.min(Math.max(0,f),o-u),R=Math.min(Math.max(0,R),r-d);const h=f*(e.width/o),I=R*(e.height/r),P=u/v*(e.width/o),B=d/v*(e.height/r);l.imageSmoothingEnabled=!0,l.drawImage(e,h,I,P,B,f,R,u,d),l.lineWidth=1.5,l.strokeStyle="rgba(255, 255, 255, 0.9)",l.strokeRect(f+.5,R+.5,u-1,d-1)},Ce=e=>{if(!e)return;const a=e.getBoundingClientRect(),t=a.width||0,o=a.height||0,r=window.devicePixelRatio||1;e.width=t*r,e.height=o*r;const n=e.getContext("2d");n&&(n.setTransform(r,0,0,r,0,0),n.clearRect(0,0,t,o))},Ta=()=>{Na(ce.value,de.value),L.value?Na(ue.value,ae.value):Ce(ae.value)},Oe=e=>{if(!e)return;const a=e.getBoundingClientRect(),t=a.height||110,o=a.width||240,r=(window.devicePixelRatio||1)*Je.value,n=Math.max(1,Math.floor(o*r)),l=Math.max(1,Math.floor(t*r));e.width=n,e.height=l;const v=e.getContext("2d");v&&(v.setTransform(1,0,0,1,0,0),v.clearRect(0,0,n,l),v.fillStyle="#0b0f16",v.fillRect(0,0,n,l))},La=()=>{const e=ce.value,a=ue.value;if(!e||!a){Z.value=!1;return}const t=Ma(["spectrogram",i.sampleName,w.value,Qe.value,Ze.value]),o=(u,d)=>{const g=u.getBoundingClientRect(),M=g.height||110,f=g.width||240,R=(window.devicePixelRatio||1)*Je.value;return`${t}${d}|${f}|${M}|${R}`},r=o(e,"|left"),n=o(a,"|right"),l=E.has(r),v=!L.value||E.has(n);if(l&&v){je(e,k.value,`${t}|left`),y.value&&L.value?je(a,y.value,`${t}|right`):Oe(a),Z.value=!1;return}Z.value=!0,Oe(e),Oe(a),requestAnimationFrame(()=>{window.setTimeout(()=>{k.value&&je(e,k.value,`${t}|left`),y.value&&L.value?je(a,y.value,`${t}|right`):Oe(a),requestAnimationFrame(()=>{Z.value=!1,O.value&&Ta()})},0)})},gt=async()=>{try{const e=await He(et.value);k.value=e,q.value=ya(e),U(i.measurementKey,"ready"),z()}catch{k.value=null,q.value=1,U(i.measurementKey,"error")}},ft=async()=>{da.value=!0,Me.value="";try{const e=await He(Xa.value);ia.value=e,U(i.cleanKey,"ready"),z()}catch{Me.value="Load failed",U(i.cleanKey,"error")}finally{da.value=!1}},Pa=async()=>{va.value=!0,Re.value="";try{const e=await He(Ke.value);y.value=e,U(w.value,"ready"),w.value===i.measurementKey&&!k.value&&(k.value=e,q.value=ya(e)),z()}catch{Re.value="Load failed",U(w.value,"error")}finally{va.value=!1}},bt=()=>{z()},wt=async e=>{const a=C.value;if(!a||!ne(e))return;Fa();const t=ke();if(t.state==="suspended")try{await t.resume()}catch{}const o=Be(e);if(pe.value===e&&!a.paused){a.pause();return}a.src!==o&&(a.src=o);try{await a.play(),pe.value=e}catch{}},Da=e=>{ne(e)&&(w.value=e,wt(e))},yt=()=>{const e=C.value;if(!e||!ne(w.value))return;Fa();const a=ke();a.state==="suspended"&&a.resume().catch(()=>{}),e.src!==Ke.value&&(e.src=Ke.value),ve.value&&(e.currentTime=0),e.paused?e.play():e.pause()},St=e=>e===i.measurementKey?"measurement":e===i.cleanKey?"ground-truth":"method",Mt=_(()=>K.value.filter(e=>e.key===i.measurementKey||e.key===i.cleanKey)),Aa=_(()=>K.value.filter(e=>e.key!==i.measurementKey&&e.key!==i.cleanKey)),Ea=e=>({"--method-color":Xe[e]||"#94a3b8"}),Ia=e=>W.value&&pe.value===e?"/logo/player-pause.svg":"/logo/player-play.svg",ge=c({text:"",x:0,y:0,visible:!1});let aa=0;const Ka=(e,a)=>{const t=vt[a];if(!t)return;window.clearTimeout(aa);const o=e.currentTarget.getBoundingClientRect();aa=window.setTimeout(()=>{ge.value={text:t,x:o.left,y:o.bottom+10,visible:!0}},1e3)},qa=()=>{window.clearTimeout(aa),ge.value={text:"",x:0,y:0,visible:!1}},Wa=e=>{if(me.value){me.value=null;return}me.value=e};let ta=null,fe=null;const za=e=>{const a=C.value;if(!a)return;const t=Math.min(2,Math.max(0,e/100));if(fe){fe.gain.value=t;return}a.volume=Math.min(1,t)},Fa=()=>{const e=C.value;if(!e||ta)return;const a=ke();ta=a.createMediaElementSource(e),fe=a.createGain(),fe.gain.value=Math.min(2,Math.max(0,x.value/100)),ta.connect(fe),fe.connect(a.destination),e.volume=1},Rt=e=>{const a=Number(e.target.value);Number.isFinite(a)&&(x.value=Math.min(200,Math.max(0,a)))},Bt=()=>{K.value.forEach(e=>{if(!(e!=null&&e.key))return;U(e.key,"loading");const a=Be(e.key);He(a).then(()=>{U(e.key,"ready")}).catch(()=>{U(e.key,"error")})})},kt=e=>{const a=C.value;if(!a||!S.value)return;const t=Number(e.target.value);a.currentTime=t/100*S.value},xt=e=>{if(!C.value||!S.value)return;const t=e.currentTarget.getBoundingClientRect(),o=Math.min(Math.max(0,e.clientX-t.left),t.width),r=t.width?o/t.width:0;ca.value=r*S.value,ua.value=o,Ae.value=!0},Ct=()=>{Ae.value=!1},Ga=(e,a)=>{if($.value!=="spectrogram")return;const t=a==="right"?ue.value:ce.value;if(!t)return;const o=t.getBoundingClientRect(),r=Math.min(Math.max(0,e.clientX-o.left),o.width),n=Math.min(Math.max(0,e.clientY-o.top),o.height);Ve.value={x:o.width?r/o.width:0,y:o.height?n/o.height:0},O.value=!0,Ta()},Ha=()=>{O.value=!1,Ce(de.value),Ce(ae.value)},re=(e,a=!1)=>{if(!Number.isFinite(e))return"00:00";const t=Math.floor(e/60),o=Math.floor(e%60);if(!a)return`${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}`;const r=Math.floor((e-Math.floor(e))*1e3);return`${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}.${String(r).padStart(3,"0")}`};let $e=0,ja=0;const sa=()=>{const e=C.value;if(!e)return;const a=performance.now();a-ja<10||(ja=a,Y.value=e.currentTime||0,S.value=e.duration||0,$.value==="waveform"&&z())},$t=()=>{const e=()=>{sa(),$e=requestAnimationFrame(e)};cancelAnimationFrame($e),$e=requestAnimationFrame(e)},oa=()=>{cancelAnimationFrame($e),$e=0};let Ne,Te;const Oa=()=>{Ue.value||!Ee.value||(Ue.value=!0,Bt(),gt(),ft(),Pa())};return Lt(()=>{if(T.value.map(a=>a.key).includes(w.value)||(w.value=i.measurementKey),Ne=new ResizeObserver(()=>{bt()}),ee.value&&Ne.observe(ee.value),ee.value&&(Te=new IntersectionObserver(a=>{const t=a[0];Ee.value=!!(t!=null&&t.isIntersecting),Ee.value&&Oa()},{root:null,threshold:.15}),Te.observe(ee.value)),C.value&&(za(x.value),C.value.addEventListener("play",()=>{W.value=!0,ve.value=!1,$t()}),C.value.addEventListener("pause",()=>{W.value=!1,oa()}),C.value.addEventListener("ended",()=>{W.value=!1,ve.value=!0,oa()}),C.value.addEventListener("loadedmetadata",()=>{sa()}),C.value.addEventListener("timeupdate",()=>{sa()})),ie.value){const a=ie.value,t=r=>{if($.value!=="waveform"){J.value=!1;return}if(!S.value){J.value=!1;return}const n=a.getBoundingClientRect(),l=Math.min(Math.max(0,r.clientX-n.left),n.width),u=Math.max(0,n.width-28),d=Y.value/S.value*u,g=Math.abs(l-d)<=4;g!==J.value&&(J.value=g,z())},o=()=>{J.value&&(J.value=!1,z())};a.addEventListener("mousemove",t),a.addEventListener("mouseleave",o),Qa(()=>{a.removeEventListener("mousemove",t),a.removeEventListener("mouseleave",o)})}}),Qa(()=>{Ne==null||Ne.disconnect(),Te==null||Te.disconnect(),oa(),E.clear()}),X(()=>i.sampleName,()=>{Ie.value={},E.clear(),Ue.value=!1,Ee.value&&Oa()}),X(()=>w.value,()=>{ve.value=!1,W.value=!1,pe.value="",Pa()}),X(()=>_e.value,()=>{z()}),X(()=>me.value,()=>{z()}),X(()=>$.value,()=>{$.value==="spectrogram"&&(Z.value=!0),$.value!=="spectrogram"&&(O.value=!1,Ce(de.value),Ce(ae.value)),z()}),X(()=>i.defaultMethod,e=>{w.value=e}),X(()=>x.value,e=>{za(e)}),X(()=>oe.value,()=>{E.clear(),$.value==="spectrogram"&&La()}),(e,a)=>(m(),p("section",{ref_key:"containerRef",ref:ee,class:"wave-compare"},[s("header",Fs,[s("div",Gs,[s("span",Hs,[ga.value?(m(),p("span",js,b(ga.value),1)):D("",!0)]),s("span",Os,[a[10]||(a[10]=s("span",{class:"wave-desc-label"},"Sample name",-1)),s("span",Us,b(lt.value),1)]),a[11]||(a[11]=s("span",{class:"wave-desc-divider","aria-hidden":"true"},null,-1)),s("span",Vs,[s("span",Ys,b(ze.value.label),1),s("span",Qs,b(ze.value.value),1),ze.value.tooltip?(m(),p("span",Zs,b(ze.value.tooltip),1)):D("",!0)])])]),s("div",Js,[s("div",Xs,[(m(!0),p(G,null,H(Mt.value,t=>(m(),p("div",{key:t.key,class:"method-chip-wrap",onMouseenter:o=>Ka(o,t.key),onMouseleave:qa},[s("button",{class:A(["method-chip",[`method-chip-${St(t.key)}`,{active:w.value===t.key,playing:W.value&&pe.value===t.key}]]),style:N(Ea(t.key)),disabled:!ne(t.key),onClick:o=>Da(t.key),type:"button"},[a[12]||(a[12]=s("span",{class:"chip-dot","aria-hidden":"true"},null,-1)),s("span",to,b(t.label),1),ne(t.key)?(m(),p("span",oo,[s("img",{class:"icon-img",src:Ia(t.key),alt:""},null,8,no)])):(m(),p("span",so))],14,ao)],40,eo))),128))]),Aa.value.length?(m(),p("div",ro,[a[14]||(a[14]=s("span",{class:"method-group-label"},"Methods",-1)),s("div",lo,[(m(!0),p(G,null,H(Aa.value,t=>(m(),p("div",{key:t.key,class:"method-chip-wrap",onMouseenter:o=>Ka(o,t.key),onMouseleave:qa},[s("button",{class:A(["method-chip method-chip-secondary",{active:w.value===t.key,playing:W.value&&pe.value===t.key}]),style:N(Ea(t.key)),disabled:!ne(t.key),onClick:o=>Da(t.key),type:"button"},[a[13]||(a[13]=s("span",{class:"chip-dot","aria-hidden":"true"},null,-1)),s("span",uo,b(t.label),1),ne(t.key)?(m(),p("span",_o,[s("img",{class:"icon-img",src:Ia(t.key),alt:""},null,8,mo)])):(m(),p("span",vo))],14,co)],40,io))),128))])])):D("",!0)]),(m(),na(Pt,{to:"body"},[ge.value.visible?(m(),p("div",{key:0,class:"method-tip-global",style:N({left:`${ge.value.x}px`,top:`${ge.value.y}px`})},b(ge.value.text),5)):D("",!0)])),s("div",po,[s("div",ho,[s("div",go,[s("span",{class:"legend-item",style:N({opacity:ct.value}),onMouseenter:a[0]||(a[0]=t=>_e.value="measurement"),onMouseleave:a[1]||(a[1]=t=>_e.value=null),onClick:a[2]||(a[2]=t=>Wa("measurement"))},[s("span",{class:"legend-swatch legend-measurement","aria-hidden":"true",style:N({background:qe.value})},null,4),ra(" "+b(ma.value),1)],36),L.value?(m(),p("span",{key:0,class:"legend-item",style:N({opacity:ut.value}),onMouseenter:a[3]||(a[3]=t=>_e.value="compare"),onMouseleave:a[4]||(a[4]=t=>_e.value=null),onClick:a[5]||(a[5]=t=>Wa("compare"))},[s("span",{class:"legend-swatch legend-compare","aria-hidden":"true",style:N({background:We.value})},null,4),ra(" "+b(_a.value),1)],36)):D("",!0)]),s("div",fo,[s("div",bo,[s("button",{class:A(["view-toggle-btn",{active:$.value==="waveform"}]),onClick:a[6]||(a[6]=t=>$.value="waveform"),type:"button"},"Waveform",2),s("button",{class:A(["view-toggle-btn",{active:$.value==="spectrogram"}]),onClick:a[7]||(a[7]=t=>$.value="spectrogram"),type:"button"},"Spectrogram",2)]),wa.value?(m(),p("span",{key:0,class:A(["wave-status",{"wave-status-error":Me.value||Re.value}])},b(wa.value),3)):D("",!0)])]),ye(s("div",wo,[s("canvas",{ref_key:"combinedCanvasRef",ref:ie,class:"wave-canvas"},null,512),Q.value?(m(),p("div",yo,"Loading...")):D("",!0)],512),[[Se,$.value==="waveform"]]),ye(s("div",So,[s("div",Mo,[(m(!0),p(G,null,H(he.value,t=>(m(),p("span",{key:t,class:A(["time-axis-tick",{"is-major":t%2===0,"is-start":t===0,"is-end":t===nt.value}]),style:N({left:`${S.value?t/S.value*100:0}%`})},[a[15]||(a[15]=s("span",{class:"time-axis-line"},null,-1)),s("span",Ro,b(t%2===0?re(t):""),1)],6))),128)),J.value?(m(),p("div",{key:0,class:"time-axis-caret",style:N({left:`${ot.value}%`})},[s("span",Bo,b(re(Y.value,!0)),1)],4)):D("",!0)])],512),[[Se,$.value==="waveform"]]),ye(s("div",ko,[s("div",xo,[s("span",Co,b(ma.value),1),a[16]||(a[16]=s("span",{class:"spectrogram-gap"},null,-1)),s("span",$o,b(L.value?_a.value:""),1)]),s("div",No,[s("div",{class:A(["spectrogram-side",{"spectrogram-hovering":O.value}]),onMousemove:a[8]||(a[8]=t=>Ga(t,"left")),onMouseleave:Ha},[s("canvas",{ref_key:"spectrogramLeftRef",ref:ce,class:"spectrogram-canvas"},null,512),ye(s("canvas",{ref_key:"spectrogramZoomLeftRef",ref:de,class:"spectrogram-zoom-canvas"},null,512),[[Se,O.value]]),s("div",To,[a[18]||(a[18]=s("span",{class:"spectrogram-axis-title"},"Frequency[kHz]",-1)),(m(!0),p(G,null,H(pa.value,t=>(m(),p("span",{key:`y-${t}`,class:"spectrogram-axis-tick",style:N({top:`${100-t/8*100}%`})},[a[17]||(a[17]=s("span",{class:"spectrogram-axis-line"},null,-1)),s("span",Lo,b(t),1)],4))),128))]),s("div",Po,[(m(!0),p(G,null,H(he.value,t=>(m(),p("span",{key:`x-left-${t}`,class:A(["spectrogram-axis-tick",{"is-major":t%2===0}]),style:N({left:`${S.value?t/S.value*100:0}%`})},[a[19]||(a[19]=s("span",{class:"spectrogram-axis-line"},null,-1)),s("span",Do,b(t%2===0?re(t):""),1)],6))),128))]),Z.value?(m(),p("div",Ao,"Loading...")):D("",!0)],34),a[23]||(a[23]=s("div",{class:"spectrogram-gap"},null,-1)),s("div",{class:A(["spectrogram-side",{"spectrogram-hovering":O.value}]),onMousemove:a[9]||(a[9]=t=>Ga(t,"right")),onMouseleave:Ha},[s("canvas",{ref_key:"spectrogramRightRef",ref:ue,class:"spectrogram-canvas"},null,512),ye(s("canvas",{ref_key:"spectrogramZoomRightRef",ref:ae,class:"spectrogram-zoom-canvas"},null,512),[[Se,O.value&&L.value]]),s("div",Eo,[a[21]||(a[21]=s("span",{class:"spectrogram-axis-title"},"Frequency[kHz]",-1)),(m(!0),p(G,null,H(pa.value,t=>(m(),p("span",{key:`y2-${t}`,class:"spectrogram-axis-tick",style:N({top:`${100-t/8*100}%`})},[a[20]||(a[20]=s("span",{class:"spectrogram-axis-line"},null,-1)),s("span",Io,b(t),1)],4))),128))]),s("div",Ko,[(m(!0),p(G,null,H(he.value,t=>(m(),p("span",{key:`x-right-${t}`,class:A(["spectrogram-axis-tick",{"is-major":t%2===0}]),style:N({left:`${S.value?t/S.value*100:0}%`})},[a[22]||(a[22]=s("span",{class:"spectrogram-axis-line"},null,-1)),s("span",qo,b(t%2===0?re(t):""),1)],6))),128))]),L.value?D("",!0):(m(),p("span",Wo,"Select a method")),Z.value&&L.value?(m(),p("div",zo,"Loading...")):D("",!0)],34)])],512),[[Se,$.value==="spectrogram"]]),ye(s("div",Fo,[a[25]||(a[25]=s("div",{class:"spectrogram-colorbar-wrap","aria-label":"Spectrogram energy scale"},[s("span",{class:"spectrogram-colorbar-label"},"0 dB"),s("div",{class:"spectrogram-colorbar"}),s("span",{class:"spectrogram-colorbar-label"},"-60 dB")],-1)),s("div",Go,[a[24]||(a[24]=s("span",{class:"spectrogram-quality-label"},"Quality",-1)),s("div",Ho,[(m(),p(G,null,H([1,2,3,4,5],t=>s("button",{key:`quality-${t}`,class:A(["spectrogram-quality-option",{active:oe.value===t}]),onClick:o=>dt(t),type:"button"},b(t),11,jo)),64))])])],512),[[Se,$.value==="spectrogram"]]),s("div",Oo,[s("button",{class:"progress-play",type:"button",onClick:yt,"aria-label":ha.value},[s("img",{class:"icon-img",src:rt.value,alt:ha.value},null,8,Vo)],8,Uo),s("span",Yo,b(re(Y.value)),1),s("div",{class:A(["progress-track",{"progress-track-hover":Ae.value}]),onMousemove:xt,onMouseleave:Ct},[s("input",{class:"progress-bar",type:"range",min:"0",max:"100",step:"0.1",value:Ye.value,style:N(at.value),onInput:kt},null,44,Qo),Ae.value?(m(),p("div",{key:0,class:"progress-tooltip",style:N({left:`${ua.value}px`})},b(st.value),5)):D("",!0)],34),s("span",Zo,"-"+b(re(tt.value)),1),s("div",Jo,[s("button",{class:"volume-button",type:"button","aria-label":ba.value},[s("img",{class:"icon-img",src:it.value,alt:ba.value},null,8,en)],8,Xo),s("div",an,[s("div",tn,b(fa.value),1),s("div",sn,[s("input",{class:"volume-slider",type:"range",min:"0",max:"200",step:"1",value:fa.value,onInput:Rt},null,40,on)]),a[26]||(a[26]=s("div",{class:"volume-scale"},"0–200",-1))])])]),s("audio",{ref_key:"audioRef",ref:C,class:"wave-audio",src:Ke.value,preload:"metadata"},null,8,nn)])],512))}},Za=Ja(ln,[["__scopeId","data-v-2482693f"]]),cn={class:"rsb-page"},un={class:"rsb-article"},dn={class:"rsb-section"},vn={class:"rsb-audio-group"},_n={class:"rsb-audio-list"},mn={class:"rsb-audio-actions"},pn=["disabled"],hn=["disabled"],gn={class:"rsb-audio-group"},fn={class:"rsb-audio-list"},bn={class:"rsb-audio-actions"},wn=["disabled"],yn=["disabled"],Sn={__name:"RSB",setup(la){const x=["051o020a_c1_454_snr=5.2.wav","051o020t_c1_473_snr=8.3.wav","053c010d_c1_896_snr=1.1.wav","053c010k_c1_903_snr=-5.0.wav","421o0307_c1_1896_snr=8.7.wav"],i=["050a050v_c1_152_t60=1.57.wav","22gc0110_c1_1161_t60=1.72.wav","420c020o_c1_1633_t60=1.19.wav","421c0214_c2_1769_t60=1.86.wav","422c020d_c2_1982_t60=1.68.wav"],j=c(!1),T=c(!1),K=c(0),w=c(0),ee=_(()=>j.value?x:[x[K.value]??x[0]].filter(Boolean)),ie=_(()=>T.value?i:[i[w.value]??i[0]].filter(Boolean)),ce=()=>{x.length&&(K.value=(K.value-1+x.length)%x.length)},ue=()=>{x.length&&(K.value=(K.value+1)%x.length)},de=()=>{i.length&&(w.value=(w.value-1+i.length)%i.length)},ae=()=>{i.length&&(w.value=(w.value+1)%i.length)},C=[{key:"Ground_Truth",label:"Ground Truth"},{key:"Measurement",label:"Measurement"},{key:"NCSN++M",label:"NCSN++M"},{key:"StoRM",label:"StoRM"},{key:"SB",label:"SB"},{key:"RSB",label:"RSB (Ours)"}];return(ia,y)=>(m(),p("section",cn,[s("article",un,[y[6]||(y[6]=Dt('<img class="rsb-watermark" src="'+At+'" alt="" aria-hidden="true" data-v-4ca4245f><header class="rsb-hero" data-v-4ca4245f><p class="rsb-kicker" data-v-4ca4245f>Paper demo</p><h1 class="rsb-title" data-v-4ca4245f>Regularized Schrödinger Bridge via Distortion-Perception Perturbation for High-Fidelity Speech Enhancement</h1><p class="rsb-authors" data-v-4ca4245f><span class="rsb-author" data-v-4ca4245f><span class="rsb-author-name" data-v-4ca4245f> Qing Yao <sup data-v-4ca4245f>1</sup></span><span class="rsb-email" data-v-4ca4245f>qyao@stmail.ujs.edu.cn</span></span><span class="rsb-author" data-v-4ca4245f><span class="rsb-author-name" data-v-4ca4245f> Lijian Gao <sup data-v-4ca4245f>1</sup></span><span class="rsb-email" data-v-4ca4245f>ljgao@ujs.edu.cn</span></span><span class="rsb-author" data-v-4ca4245f><span class="rsb-author-name" data-v-4ca4245f> Qirong Mao <sup data-v-4ca4245f>1</sup><sup class="rsb-tag" data-v-4ca4245f>†</sup></span><span class="rsb-email" data-v-4ca4245f>mao_qr@ujs.edu.cn</span></span><span class="rsb-author" data-v-4ca4245f><span class="rsb-author-name" data-v-4ca4245f> Ming Dong <sup data-v-4ca4245f>2</sup><sup class="rsb-tag" data-v-4ca4245f>†</sup></span><span class="rsb-email" data-v-4ca4245f>mdong@wayne.edu</span></span></p><ol class="rsb-affiliations" data-v-4ca4245f><li data-v-4ca4245f><sup data-v-4ca4245f>1</sup> Jiangsu University </li><li data-v-4ca4245f><sup data-v-4ca4245f>2</sup> Wayne State University </li></ol><p class="rsb-affiliation-note" data-v-4ca4245f><sup class="rsb-tag" data-v-4ca4245f>†</sup> Corresponding Author </p></header><nav class="rsb-nav" data-v-4ca4245f><span class="rsb-nav-title" data-v-4ca4245f>Quick Access</span><a class="rsb-nav-link rsb-nav-disabled" href="" aria-label="Paper link" aria-disabled="true" tabindex="-1" data-v-4ca4245f><span class="rsb-nav-icon rsb-nav-icon-demo" aria-hidden="true" data-v-4ca4245f></span> Paper </a><a class="rsb-nav-link" href="https://github.com/Yorch233/RSB/" aria-label="Github repository link" aria-disabled="true" tabindex="-1" data-v-4ca4245f><img class="rsb-nav-icon" src="https://github.githubassets.com/favicons/favicon.svg" alt="" data-v-4ca4245f> Github </a><a class="rsb-nav-link" href="https://huggingface.co/Yorch233/RSB/" aria-label="Hugging Face repository link" aria-disabled="true" tabindex="-1" data-v-4ca4245f><img class="rsb-nav-icon" src="https://huggingface.co/front/assets/huggingface_logo-noborder.svg" alt="" data-v-4ca4245f> Hugging Face </a><a class="rsb-nav-link rsb-nav-disabled" href="https://huggingface.co/spaces/Yorch233/RSB/" aria-label="Online demo link" aria-disabled="true" tabindex="-1" data-v-4ca4245f><img class="rsb-nav-icon" src="https://huggingface.co/front/assets/huggingface_logo-noborder.svg" alt="" data-v-4ca4245f> Online Demo </a></nav><section class="rsb-section" data-v-4ca4245f><h2 data-v-4ca4245f><span class="rsb-wave" aria-hidden="true" data-v-4ca4245f><span data-v-4ca4245f></span></span> Abstract </h2><p class="rsb-abstract" data-v-4ca4245f> Speech enhancement (SE) requires high-fidelity reconstruction of clean speech that preserves linguistic and paralinguistic cues while maintaining high perceptual quality. Recently, Schrödinger Bridge (SB), a family of diffusion-based generative models, has advanced SE by bridging degraded and clean speech distributions in a principled formulation, enabling higher-quality reconstructions with fewer sampling steps. However, diffusion-based SE methods still face two challenges: (1) the fidelity-realism tradeoff, where they often prioritize perceptual realism encouraged by the learned speech prior, at the expense of fidelity; and (2) the exposure bias issue, where iterative multi-step sampling causes early-step prediction errors to accumulate along the sampling trajectory and degrade enhanced speech quality. In this paper, we analyze standard SB training and show that it induces a systematic prediction drift, which biases the multi-step trajectory and amplifies error accumulation. To address this, we propose Regularized Schrödinger Bridge (RSB) for high-fidelity SE, a generative approach that reconciles fidelity and realism while mitigating exposure bias. RSB regularizes training with a Distortion-Perception Perturbation that constructs time-varying targets by interpolating between clean speech and posterior-mean estimates, and trains the network on perturbed intermediate states to correct toward the ground truth progressively. Consequently, such perturbation simulates inference-time prediction errors, mitigating the training–inference mismatch and thereby reducing exposure bias. Furthermore, it also injects posterior-mean estimates as fidelity-preserving guidance, facilitating reconstruction fidelity. Experiments on the WSJ0 corpus and VoiceBank+DEMAND dataset demonstrate that RSB improves reconstruction fidelity over the advanced SE baselines, yielding a favorable fidelity-realism tradeoff and reducing exposure bias. </p></section><section class="rsb-section" data-v-4ca4245f><h2 data-v-4ca4245f><span class="rsb-wave" aria-hidden="true" data-v-4ca4245f><span data-v-4ca4245f></span></span> Keywords </h2><div class="rsb-meta" data-v-4ca4245f><span class="rsb-chip" data-v-4ca4245f>Speech enhancement</span><span class="rsb-chip" data-v-4ca4245f>Schrödinger bridge</span><span class="rsb-chip" data-v-4ca4245f>Diffusion models</span><span class="rsb-chip" data-v-4ca4245f>Distortion-perception tradeoff</span><span class="rsb-chip" data-v-4ca4245f>Exposure bias</span></div></section>',5)),s("section",dn,[y[4]||(y[4]=s("h2",null,[s("span",{class:"rsb-wave","aria-hidden":"true"},[s("span")]),ra(" Audio Samples ")],-1)),y[5]||(y[5]=s("p",{class:"rsb-muted"},"We publicly release 10 samples in total, drawn from two synthetic datasets: WSJ0+WHAM is the denoising dataset and WSJ0+REVERB is the dereverberation dataset.",-1)),s("div",vn,[y[2]||(y[2]=s("h3",{class:"rsb-subtitle"},"WSJ0+WHAM (Denoising)",-1)),s("div",_n,[(m(!0),p(G,null,H(ee.value,(k,q)=>(m(),na(Za,{key:k,"sample-name":k,"sample-index":j.value?q+1:K.value+1,methods:C,"default-method":"Measurement"},null,8,["sample-name","sample-index"]))),128))]),s("div",mn,[s("button",{class:"rsb-nav-btn",type:"button",disabled:j.value,onClick:ce},"Previous",8,pn),s("button",{class:"rsb-show-more",type:"button",onClick:y[0]||(y[0]=k=>j.value=!j.value)},b(j.value?"Hiden":"Show More"),1),s("button",{class:"rsb-nav-btn",type:"button",disabled:j.value,onClick:ue},"Next",8,hn)])]),s("div",gn,[y[3]||(y[3]=s("h3",{class:"rsb-subtitle"},"WSJ0+REVERB (Dereverberation)",-1)),s("div",fn,[(m(!0),p(G,null,H(ie.value,(k,q)=>(m(),na(Za,{key:k,"sample-name":k,"sample-index":T.value?q+1:w.value+1,methods:C,"default-method":"Measurement"},null,8,["sample-name","sample-index"]))),128))]),s("div",bn,[s("button",{class:"rsb-nav-btn",type:"button",disabled:T.value,onClick:de},"Previous",8,wn),s("button",{class:"rsb-show-more",type:"button",onClick:y[1]||(y[1]=k=>T.value=!T.value)},b(T.value?"Hiden":"Show More"),1),s("button",{class:"rsb-nav-btn",type:"button",disabled:T.value,onClick:ae},"Next",8,yn)])])])])]))}},Rn=Ja(Sn,[["__scopeId","data-v-4ca4245f"]]);export{Rn as default};
